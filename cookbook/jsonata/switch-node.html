<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.0">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><title>Switch node | node-red-contrib-home-assistant-websocket</title><meta name="description" content="Node-RED integration with Home Assistant through the WebSocket and HTTP API">
    <link rel="preload" href="/node-red-contrib-home-assistant-websocket/assets/style-d4kv5SXb.css" as="style"><link rel="stylesheet" href="/node-red-contrib-home-assistant-websocket/assets/style-d4kv5SXb.css">
    <link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/app-2RG98JVF.js"><link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/switch-node.html-RvdXaQb9.js"><link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/switch-node.html-Nsrto0OI.js">
    <link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/FAQ.html-6d_WpebR.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-AQDQ1uve.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-mg0Zdmo7.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/actionable-notifications-subflow-for-android.html-8D_MMyoT.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/check-if-an-entity-was-turned-on-in-the-last-24-hours.html-4eJFKjVN.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/expiration-date-monitor.html-2US7q6Qj.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-state_changed-events-based-on-area.html-v0DuRF6f.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/holiday-lights-scheduler-and-demo-mode-for-wled.html-jiBqzI6K.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/motion-triggered-light.html-w7WQXAl9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/saving-and-restoring-states.html-36-zuW6r.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/starting-flow-after-home-assistant-restart.html-wyB9YmUi.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sun-events.html-58pms6D7.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/using-date-and-time-entities-to-trigger-flows.html-HiaEBufY.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/vacation-mode.html-oP89ujsJ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-MeZqBzV4.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-l0kJTBkB.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/conditionals.html-ywksL6EW.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/development.html-rEFWE-Al.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/diagnostics.html-awqVedd8.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/documentation.html-Sk_kOkse.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/first-automation.html-NxDejyRa.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/jsonata-primer.html-DdZ31KE_.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/jsonata.html-vSChhE2D.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/migration.html-OT6ByC_T.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/mustache-templates.html-KxuVHTHr.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/API.html-RC3NATXF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-_Z-dqKX1.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/binary-sensor.html-2MYmI1uf.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/button.html-qZx1bAfG.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-J0Zo23Gi.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/config-server.html-N2FRXCT4.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-_HemfHgW.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device-config.html-FY0qcWse.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device.html-z1FLqquI.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity-config.html-FAvbWZkG.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity.html-w41r4_Qq.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-all.html-05Rv5IYL.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-calendar.html-nWg6TvbI.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-_XjK4cPp.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/fire-event.html-9wDuFgpq.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-entities.html-rpNOZK4g.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-history.html-fb1vfLfI.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/number.html-GN42PUcY.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/poll-state.html-NvLyNeRB.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/render-template.html-GmGaIofY.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/select.html-46dUvQCx.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-LQJzdcbG.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sentence.html-abhvVOOn.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/switch.html-qLcmu40c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/tag.html-P1MWBnMF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/text.html-uY5lo5Zp.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time-entity.html-kZX0Kkre.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time.html-7k3OqXNl.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-bCtagKou.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/update-config.html-uefxpwG7.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/wait-until.html-hjvmN2NC.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/webhook.html-Ykznt6Ew.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/zone.html-cjb-NyuD.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-wbizxQii.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-QvI6abGO.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/change-node.html-qINjafcB.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-oWmvL-Y9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-SE2C_DFF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/functions.html-DnMlzTQF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-4gOKGMaI.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-_cJcGSEE.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-brRcROGF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/exposed-nodes.html-bAMiicnC.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/404.html-6Yl8cQE3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/FAQ.html-FYONgvtJ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-tM1ML-VF.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-WOTpraX9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/actionable-notifications-subflow-for-android.html-ga8Uu-ZG.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/check-if-an-entity-was-turned-on-in-the-last-24-hours.html-lpEyVtZw.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/expiration-date-monitor.html-6D8BYw_e.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-state_changed-events-based-on-area.html-yMazAWPZ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/holiday-lights-scheduler-and-demo-mode-for-wled.html-ExlBkgXv.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/motion-triggered-light.html-L2NGY7li.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/saving-and-restoring-states.html-BHZyIOqP.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/starting-flow-after-home-assistant-restart.html-y0Wurh4m.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sun-events.html-Xvs94SJV.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/using-date-and-time-entities-to-trigger-flows.html-yZ1lq4C5.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/vacation-mode.html-DulIWXEz.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-T2jqbeym.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-kWn05GJ1.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/conditionals.html-dcbMXBUX.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/development.html-xH3M5PGN.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/diagnostics.html-FrsYSvPG.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/documentation.html-7EHsvzug.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/first-automation.html-M6yDuM0w.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/jsonata-primer.html-_bbNp0VA.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/jsonata.html-XRwfN_0s.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/migration.html-U6tndZRC.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/mustache-templates.html-UyRWZ6vo.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/API.html-oXWh_bXq.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-VWV5yUSD.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/binary-sensor.html-gouYV6Mi.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/button.html-BKx5TIWo.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-wOGGEwp0.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/config-server.html-Ut9tb0fE.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-LFifvUF0.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device-config.html-tscm7n3i.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device.html-PUNM7Rog.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity-config.html-Uixrp9Ek.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity.html-KRa3tYGa.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-all.html-X-nEhBoo.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-calendar.html-fWlesrpf.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-dmTUbAe9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/fire-event.html-DypNASOL.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-entities.html-kWF5FILL.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-history.html-R-eEMEIr.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/number.html-vjPrBDFw.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/poll-state.html-74-Oq0lV.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/render-template.html-tJ5W_wMi.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/select.html-uceQ8aJN.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-v5UEdAZz.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sentence.html-Q7D_PWEx.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/switch.html-w7TixXia.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/tag.html-n0XfVgpQ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/text.html-e0gWQuEo.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time-entity.html-VQtl8d_N.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time.html-_gq9wQv-.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-TnYlVgDW.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/update-config.html-UrSab64o.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/wait-until.html-6bLf6bhR.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/webhook.html-AjX7yjIw.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/zone.html-j3bI3iZN.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-dQvLWN7B.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-hU75CTcH.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/change-node.html-xC4VXpea.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-WQWM4tHA.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-FUf9-Ovw.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/functions.html-2muraxFQ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-mOROjwi0.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-qv3ADXff.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-AdagKyFn.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/exposed-nodes.html-Mnvs9-Hg.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/404.html-CXe3wkqJ.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/DocsOnly-xBI0wMbk.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/InfoPanelOnly-fqvI1G_x.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/Scrubber-q3dEAxnv.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/node-red-contrib-home-assistant-websocket/" class=""><!----><span class="site-name">node-red-contrib-home-assistant-websocket</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/guide/" class="" aria-label="Guides"><!--[--><!--]--> Guides <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/node/" class="" aria-label="Nodes"><!--[--><!--]--> Nodes <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/FAQ.md" class="" aria-label="FAQ"><!--[--><!--]--> FAQ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/cookbook/" class="router-link-active" aria-label="Cookbook"><!--[--><!--]--> Cookbook <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/scrubber/" class="" aria-label="Scrubber"><!--[--><!--]--> Scrubber <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/discussions" rel="noopener noreferrer" target="_blank" aria-label="Forums"><!--[--><!--]--> Forums <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/guide/" class="" aria-label="Guides"><!--[--><!--]--> Guides <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/node/" class="" aria-label="Nodes"><!--[--><!--]--> Nodes <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/FAQ.md" class="" aria-label="FAQ"><!--[--><!--]--> FAQ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/cookbook/" class="router-link-active" aria-label="Cookbook"><!--[--><!--]--> Cookbook <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/scrubber/" class="" aria-label="Scrubber"><!--[--><!--]--> Scrubber <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/discussions" rel="noopener noreferrer" target="_blank" aria-label="Forums"><!--[--><!--]--> Forums <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Cookbook <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item active">JSONata <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/call-service.html" class="sidebar-item" aria-label="Call Service"><!--[--><!--]--> Call Service <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/change-node.html" class="sidebar-item" aria-label="Change node"><!--[--><!--]--> Change node <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/current-state.html" class="sidebar-item" aria-label="Current State"><!--[--><!--]--> Current State <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/events-state.html" class="sidebar-item" aria-label="Events: state"><!--[--><!--]--> Events: state <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/functions.html" class="sidebar-item" aria-label="Other functions"><!--[--><!--]--> Other functions <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/sensor.html" class="sidebar-item" aria-label="Sensor"><!--[--><!--]--> Sensor <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/switch-node.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Switch node"><!--[--><!--]--> Switch node <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/switch-node.html#using-jsonata-in-switch-routing" class="router-link-active router-link-exact-active sidebar-item" aria-label="Using JSONata in switch routing"><!--[--><!--]--> Using JSONata in switch routing <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/trigger-state.html" class="sidebar-item" aria-label="Trigger: state"><!--[--><!--]--> Trigger: state <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/motion-triggered-light.html" class="sidebar-item" aria-label="Motion Triggered Light"><!--[--><!--]--> Motion Triggered Light <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/saving-and-restoring-states.html" class="sidebar-item" aria-label="Saving and Restoring States"><!--[--><!--]--> Saving and Restoring States <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/get-state_changed-events-based-on-area.html" class="sidebar-item" aria-label="Get state_changed Events Based on Area"><!--[--><!--]--> Get state_changed Events Based on Area <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/sun-events.html" class="sidebar-item" aria-label="Turn Light On/Off with Sunset/Sunrise"><!--[--><!--]--> Turn Light On/Off with Sunset/Sunrise <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/vacation-mode.html" class="sidebar-item" aria-label="Vacation Mode"><!--[--><!--]--> Vacation Mode <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/expiration-date-monitor.html" class="sidebar-item" aria-label="Expiration Date Monitor with notification"><!--[--><!--]--> Expiration Date Monitor with notification <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/using-date-and-time-entities-to-trigger-flows.html" class="sidebar-item" aria-label="Using Date and Time entities to trigger flows"><!--[--><!--]--> Using Date and Time entities to trigger flows <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/check-if-an-entity-was-turned-on-in-the-last-24-hours.html" class="sidebar-item" aria-label="Check if an entity was a certain state in the last 24 hours"><!--[--><!--]--> Check if an entity was a certain state in the last 24 hours <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/starting-flow-after-home-assistant-restart.html" class="sidebar-item" aria-label="Starting a flow after a Home Assistant restart"><!--[--><!--]--> Starting a flow after a Home Assistant restart <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/holiday-lights-scheduler-and-demo-mode-for-wled.html" class="sidebar-item" aria-label="Holiday lights scheduler and demo mode for WLED"><!--[--><!--]--> Holiday lights scheduler and demo mode for WLED <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/actionable-notifications-subflow-for-android.html" class="sidebar-item" aria-label="Actionable Notifications Subflow for Android"><!--[--><!--]--> Actionable Notifications Subflow for Android <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="switch-node" tabindex="-1"><a class="header-anchor" href="#switch-node" aria-hidden="true">#</a> Switch node</h1><p>The <em>Switch</em> node and the <em>Change</em> node are standard Node-RED nodes that provide conditional routing (selection) and data manipulation respectively for flow messages. Many of the WebSocket nodes, when using JSONata, can provide some output property data manipulation, and a few nodes also offer simple binary output message routing. However, much more can be achieved using JSONata in Switch and Change nodes in combination with the WebSocket nodes.</p><p><img src="/node-red-contrib-home-assistant-websocket/assets/jsonata_6_1-nPLWwTK6.png" alt="screenshot"></p><p>This example shows how to use JSONata within the standard Switch node.</p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;fcb0d3b1b8ed3478&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;group&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Switch node - selection routing based on entity details&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;style&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;label&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;color&quot;</span><span class="token operator">:</span><span class="token string">&quot;#000000&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token property">&quot;nodes&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;7f01d6eef386f743&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;84b7ac3a7e469780&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;60331de530222f6f&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;e253c6a934a17919&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;76bb91be0ae4c7b4&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;52713f1b7157f1f0&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2159</span><span class="token punctuation">,</span><span class="token property">&quot;w&quot;</span><span class="token operator">:</span><span class="token number">852</span><span class="token punctuation">,</span><span class="token property">&quot;h&quot;</span><span class="token operator">:</span><span class="token number">262</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;7f01d6eef386f743&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;poll-state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;fcb0d3b1b8ed3478&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;server&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;exposeAsEntityConfig&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;updateInterval&quot;</span><span class="token operator">:</span><span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;updateIntervalType&quot;</span><span class="token operator">:</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;updateIntervalUnits&quot;</span><span class="token operator">:</span><span class="token string">&quot;seconds&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputInitially&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;outputOnChanged&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;entityId&quot;</span><span class="token operator">:</span><span class="token string">&quot;switch.t1&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;stateType&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ifState&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ifStateType&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ifStateOperator&quot;</span><span class="token operator">:</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;outputProperties&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;valueType&quot;</span><span class="token operator">:</span><span class="token string">&quot;entityState&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;valueType&quot;</span><span class="token operator">:</span><span class="token string">&quot;entity&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;topic&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;valueType&quot;</span><span class="token operator">:</span><span class="token string">&quot;triggerId&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2240</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;84b7ac3a7e469780&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;84b7ac3a7e469780&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;switch&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;fcb0d3b1b8ed3478&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;property&quot;</span><span class="token operator">:</span><span class="token string">&quot;$round(data.timeSinceChangedMs/60000,0)&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;rules&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;t&quot;</span><span class="token operator">:</span><span class="token string">&quot;btwn&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;v&quot;</span><span class="token operator">:</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;vt&quot;</span><span class="token operator">:</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;v2&quot;</span><span class="token operator">:</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;v2t&quot;</span><span class="token operator">:</span><span class="token string">&quot;num&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;t&quot;</span><span class="token operator">:</span><span class="token string">&quot;gt&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;v&quot;</span><span class="token operator">:</span><span class="token string">&quot;data.state=\&quot;on\&quot; ? 4 : 1&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;vt&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;t&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata_exp&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;v&quot;</span><span class="token operator">:</span><span class="token string">&quot;data.timeSinceChangedMs &lt; 60000&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;vt&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;t&quot;</span><span class="token operator">:</span><span class="token string">&quot;else&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;checkall&quot;</span><span class="token operator">:</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;repair&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">350</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2240</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;60331de530222f6f&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;e253c6a934a17919&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;76bb91be0ae4c7b4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;52713f1b7157f1f0&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;60331de530222f6f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;fcb0d3b1b8ed3478&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Last changed between 2 and 3 minutes ago&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;\&quot;Is \&quot; &amp; payload &amp; \&quot; for \&quot; &amp; $round(data.timeSinceChangedMs/60000, 0) &amp; \&quot; minutes\&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">670</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2200</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;e253c6a934a17919&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;fcb0d3b1b8ed3478&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;If on &gt; 4 mins or if off &gt; 1 mins&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;\&quot;Is \&quot; &amp; payload &amp; \&quot; for \&quot; &amp; $round(data.timeSinceChangedMs/60000, 0) &amp; \&quot; minutes\&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">630</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2260</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;76bb91be0ae4c7b4&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;fcb0d3b1b8ed3478&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Changed state &lt; 1 minute ago&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;\&quot;Is \&quot; &amp; payload &amp; \&quot; for \&quot; &amp; $round(data.timeSinceChangedMs/60000, 0) &amp; \&quot; minutes\&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">630</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2320</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;52713f1b7157f1f0&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;776c027950fc8c3f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;g&quot;</span><span class="token operator">:</span><span class="token string">&quot;fcb0d3b1b8ed3478&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Otherwise&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;active&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;tosidebar&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;console&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;tostatus&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;complete&quot;</span><span class="token operator">:</span><span class="token string">&quot;\&quot;Is \&quot; &amp; payload &amp; \&quot; for \&quot; &amp; $round(data.timeSinceChangedMs/60000, 0) &amp; \&quot; minutes\&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusVal&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;statusType&quot;</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">560</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">2380</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="using-jsonata-in-switch-routing" tabindex="-1"><a class="header-anchor" href="#using-jsonata-in-switch-routing" aria-hidden="true">#</a> Using JSONata in <em>switch routing</em></h3><p>A Poll State node has been set up to return the entity state of a light switch every 10 seconds. This will return the entity state (&quot;on&quot; or &quot;off&quot;) as the <em>msg.payload</em> value. It will also return the fuller entity state details in <em>msg.data</em>, which includes the <em>&#39;timeSinceChangedMs&#39;</em> field.</p><p><strong>JSONata for the routing <em>property</em></strong></p><div class="language-text" data-ext="text"><pre class="language-text"><code>$round(data.timeSinceChangedMs/60000,0)
</code></pre></div><p>The routing rules will test against the given <em>property</em>. By default this would be the value held in msg.payload. Using a JSONata expression here allows for a computation on the time since changed field to convert this to minutes. Rounding is also being used, so 31 to 89 seconds would become 1 minute.</p><p><strong>Note</strong> that the JSONata expression has access to the full incoming message. The value required was output from the Poll State node within the output property <em>msg.data</em> field, and this has to be used here since the <code>$entity()</code> functions are not available outside of the WebSocket nodes.</p><p><img src="/node-red-contrib-home-assistant-websocket/assets/jsonata_6_2-p4ZHa32c.png" alt="screenshot"></p><p><strong>JSONata for the <em>rule value</em></strong></p><ol><li><p>In the first rule, the rule values to test against are given as literals.</p></li><li><p>In the second rule, the rule test value is provided by a JSONata expression. This will return either 4, if the light state is &quot;on&quot;, or 1 if the light state is &quot;off&quot;.</p></li></ol><div class="language-text" data-ext="text"><pre class="language-text"><code>data.state=&quot;on&quot; ? 4 : 1
</code></pre></div><p><strong>Note</strong> that &#39;payload&#39; contains the state value and could have been used rather than &#39;data.state&#39;. Where the output of a WebSocket node is used later in the flow for routing or processing, care should be taken to generate the most appropriate output. For example, rather than generate the Property match value here, this JSONata expression could be used in the Poll State node to provide minutes since last changed in the output msg.payload directly.</p><p><strong>JSONata expression for the routing <em>match</em></strong></p><ol start="3"><li>In the third rule, the evaluation Property is not used. The test condition is the Boolean result of a JSONata expression. The routing path is taken only if the JSONata expression evaluates as <code>true</code>.</li></ol><div class="language-text" data-ext="text"><pre class="language-text"><code>data.timeSinceChangedMs &lt; 60000
</code></pre></div><p>The example is simplistic, however it shows that any incoming message property can be used within the expression.</p><p><strong>Note</strong> that, since the <code>$entities()</code> function is not available in a Switch node, to obtain other entity values, JSONata can be used in the preceding Poll State node to generate an output property, for example by setting <em>msg.time</em> to <code>$entities(&#39;sensor.time&#39;).state</code> to provide &#39;time&#39; as an available value for use in the Switch node.</p><ol start="4"><li>For completeness in these notes, a last rule of &#39;Otherwise&#39; has been included, and the matching rules set to &#39;checking all rules&#39;. This will mean that more than one of the first three rules may match at the same time, but that the last route is only taken when no other rule matches.</li></ol><p><strong>JSONata expression in the <em>Debug</em> node</strong></p><p>The Debug nodes also contain JSONata as a further demonstration of how versatile and applicable this language can be.</p><p><strong>Also see:</strong></p><ul><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/guide/jsonata.html" class="">JSONata guide</a></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/guide/jsonata-primer.html" class="">JSONata primer</a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/edit/main/docs/cookbook/jsonata/switch-node.md" rel="noopener noreferrer" target="_blank" aria-label="Help us improve this page!"><!--[--><!--]--> Help us improve this page! <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 37859597+zachowj@users.noreply.github.com">Jason</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/sensor.html" class="" aria-label="Sensor"><!--[--><!--]--> Sensor <!--[--><!--]--></a></span><span class="next"><a href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata/trigger-state.html" class="" aria-label="Trigger: state"><!--[--><!--]--> Trigger: state <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/node-red-contrib-home-assistant-websocket/assets/app-2RG98JVF.js" defer></script>
  </body>
</html>
